:root {
  --rail-w: 56px;
  --rail-expanded-w: 240px;
  --rail-left: 12px;
  --rail-top: 16px;
  --rail-bg: rgba(20, 28, 38, 0.85); /* Slightly more opaque for readability */
  --rail-blur: 24px;
  --rail-border: rgba(255, 255, 255, 0.1);
  /* The height of the double-button capsule (44px * 2) */
  --trigger-group-height: 88px;
}

/* --- THE DOUBLE-DECKER TRIGGER CAPSULE --- */
.rail-trigger-group {
  position: fixed;
  top: var(--rail-top);
  left: var(--rail-left);
  width: var(--rail-w);
  height: var(--trigger-group-height);
  z-index: 10002;

  display: flex;
  flex-direction: column;

  background: var(--rail-bg);
  backdrop-filter: blur(var(--rail-blur));
  -webkit-backdrop-filter: blur(var(--rail-blur));
  border: 1px solid var(--rail-border);
  border-radius: 28px; /* Fully rounded capsule */

  transition: border-radius 200ms ease;
  overflow: hidden; /* Keeps child buttons inside the rounded corners */
}

/* Glue logic: Flatten bottom when rail is open */
.rail-trigger-group.is-open {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
  border-bottom-color: transparent;
}

/* Individual Buttons inside the capsule */
.rail-btn {
  flex: 1; /* Takes up 50% height each */
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: rgba(255, 255, 255, 0.5);
  cursor: pointer;
  transition: all 200ms ease;
  position: relative;
}

/* Divider line between the two buttons */
.rail-btn:first-child {
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.rail-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
}

/* Active State (The selected mode) */
.rail-btn.active {
  color: #fff;
  background: rgba(80, 150, 255, 0.2);
}

/* --- THE UNIFIED RAIL --- */
.unified-liquid-rail {
  position: fixed;
  /* Attached exactly to bottom of trigger group */
  top: calc(var(--rail-top) + var(--trigger-group-height) - 1px);
  left: var(--rail-left);
  width: var(--rail-w);

  background: var(--rail-bg);
  backdrop-filter: blur(var(--rail-blur));
  -webkit-backdrop-filter: blur(var(--rail-blur));
  border: 1px solid var(--rail-border);

  /* Initial State: Hidden & Slide Up */
  opacity: 0;
  transform: translateY(-10px);
  pointer-events: none;
  z-index: 10001;

  border-radius: 12px;
  display: flex;
  flex-direction: column;

  transition: width 300ms cubic-bezier(0.2, 0.8, 0.2, 1), opacity 200ms ease, transform 200ms ease;
}

.unified-liquid-rail.open {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;

  /* Glue logic: Flatten top to merge with trigger */
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  border-top-color: transparent;
}

.unified-liquid-rail.expanded {
  width: var(--rail-expanded-w);
}

/* --- SCROLL & KEYBOARD FIX --- */
.rail-scroll-area {
  padding: 8px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;

  /* KEYBOARD FIX:
     1. dvh adapts to mobile browser bars appearing/disappearing.
     2. Subtract top offset (16px) + trigger height (88px) + keyboard buffer (20px)
  */
  max-height: calc(100dvh - 130px);

  /* Prevent scroll chaining (scrolling the rail won't scroll the page behind it) */
  overscroll-behavior: contain;
}

/* Hide scrollbar but keep functionality */
.rail-scroll-area::-webkit-scrollbar {
  width: 4px;
}
.rail-scroll-area::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.2);
  border-radius: 4px;
}
